$.ajaxSetup({timeout:2E4,type:"POST",dataType:"json",cache:!1});
function ajax_error(a,b){switch(a){case "timeout":showMessage("warning","\u0412\u0440\u0435\u043c\u044f \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u044f \u0438\u0441\u0442\u0435\u043a\u043b\u043e. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.");break;case "parsererror":showMessage("warning","\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0430\u0440\u0441\u0435\u0440\u0430. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.");break;
case "abort":showMessage("info","\u0417\u0430\u043f\u0440\u043e\u0441 \u0431\u044b\u043b \u043e\u0442\u043c\u0435\u043d\u0451\u043d.");break;case "error":showMessage("danger","\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430: "+b+". \u041f\u0435\u0440\u0435\u0434\u0430\u0439\u0442\u0435 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u0438 \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.");
break;default:showMessage("danger","\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.")}}function ajax_waiter(a){"show"==a?($("#ajax_waiter").show(),$("#ajax_overlay").show()):($("#ajax_waiter").hide(),$("#ajax_overlay").hide())}
var cSpeed=4,cWidth=100,cHeight=103,cTotalFrames=20,cFrameWidth=100,cImageSrc=pathRoot+"/images/loader.gif",cImageTimeout=!1,cIndex=0,cXpos=0,cPreloaderTimeout=!1,SECONDS_BETWEEN_FRAMES=0;
function startAnimation(){document.getElementById("ajax_loader").style.backgroundImage="url("+cImageSrc+")";document.getElementById("ajax_loader").style.width=cWidth+"px";document.getElementById("ajax_loader").style.height=cHeight+"px";FPS=Math.round(100/cSpeed);SECONDS_BETWEEN_FRAMES=1/FPS;cPreloaderTimeout=setTimeout("continueAnimation()",SECONDS_BETWEEN_FRAMES/1E3)}
function continueAnimation(){cXpos+=cFrameWidth;cIndex+=1;cIndex>=cTotalFrames&&(cIndex=cXpos=0);document.getElementById("ajax_loader")&&(document.getElementById("ajax_loader").style.backgroundPosition=-cXpos+"px 0");cPreloaderTimeout=setTimeout("continueAnimation()",1E3*SECONDS_BETWEEN_FRAMES)}function stopAnimation(){clearTimeout(cPreloaderTimeout);cPreloaderTimeout=!1}
function imageLoader(a,b){clearTimeout(cImageTimeout);cImageTimeout=0;genImage=new Image;genImage.onload=function(){cImageTimeout=setTimeout(b,0)};genImage.onerror=new Function("alert('Could not load the image')");genImage.src=a}new imageLoader(cImageSrc,"startAnimation()");
$("body").on("click",".forma_submit",function(){var a=$(this).attr("data-forma");if($("#"+a+"_forma").validationEngine("validate"))switch(a){case "user_reg":ajax_waiter("show");$.ajax({url:pathRoot+"/user/add",data:{ajax:!0,name:$("#forma_reg_name").val(),email:$("#forma_reg_email").val()},success:function(b,a,c){windowClose("user_reg");showMessage(b.code,b.text)},complete:function(){ajax_waiter("hide")},error:function(b,a,c){ajax_error(a,c)}});break;case "user_lost":ajax_waiter("show");$.ajax({url:pathRoot+
"/user/lost_password",data:{ajax:!0,email:$("#forma_lost_email").val()},success:function(b,a,c){windowClose("user_lost");showMessage(b.code,b.text)},complete:function(){ajax_waiter("hide")},error:function(b,a,c){ajax_error(a,c)}});break;case "user_save":ajax_waiter("show"),$.ajax({url:pathRoot+"/user/save",data:{ajax:!0,name:$("#forma_users_save_name").val(),password:$("#forma_users_save_password").val(),newpassword:$("#forma_users_save_newpassword:checked").val()},success:function(b,a,c){$(".userinfo_name").text($("#forma_users_save_name").val());
showMessage(b.code,b.text)},complete:function(){ajax_waiter("hide")},error:function(a,d,c){ajax_error(d,c)}})}});